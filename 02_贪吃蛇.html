<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		*{
			margin: 0;
			padding: 0;
		}
		table{
			margin: 20px auto;
			border-collapse: collapse;
		}
		td{
			border: 1px solid #333;
			width: 23px;
			height: 23px;
		}
	</style>
</head>
<body>
	<h2>分数：0</h2>
	<!-- 自己规定表格是20行，20列，一个tr里面有20个td，一共有20个tr -->
	<table>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
		<tr>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
			<td></td>
		</tr>
	</table>
	<script>
		//分数
		var score = 0;
		//决定方向的信号量
		var fangxiang = "right";
		//设置一个存放蛇的数组
		var snakeArr = [
		{"row":5,"col":7},
		{"row":5,"col":6},
		{"row":5,"col":5},
		{"row":5,"col":4}
		]
		//功能就是设置表格变颜色
		function setColor(row,col,color){
			document.getElementsByTagName("tr")[row].getElementsByTagName("td")[col].style.background = color
		}
		//渲染蛇
		function renderSnake(){
			//判断蛇的死亡，自己吃掉自己的死亡判断,下面的循环从1开始，因为我们要用头和身体的每一个部位去判断，身体从1开始
			for(var j = 1; j < snakeArr.length; j++){
				if(snakeArr[0].row == snakeArr[j].row && snakeArr[0].col == snakeArr[j].col){
					die()
					return
				}
			}
			for(var i = 0; i < snakeArr.length; i++){
				setColor(snakeArr[i].row,snakeArr[i].col,"blue")
			}
		}
		renderSnake()
		// 清除表格上所有的颜色
		function clear(){
			for(var i = 0; i < 20; i ++){
				for(var j = 0; j < 20; j++){
					setColor(i,j,"")
				}
			}
		}
		//键盘事件
		document.onkeydown = function(e){
			//键盘码左37，上38，右39，下40
			if(e.keyCode == 37){
				//当蛇在向右运动的时候不能按左
				if(fangxiang == "right") return
				fangxiang = "left"
			}else if(e.keyCode == 38){
				//当蛇在向下运动的时候不能按上
				if(fangxiang == "down") return
				fangxiang = "up"
			}else if(e.keyCode == 39){
				//当蛇在向左运动的时候不能按右
				if(fangxiang == "left") return
				fangxiang = "right"
			}else if(e.keyCode == 40){
				//当蛇在向上运动的时候不能按下
				if(fangxiang == "up") return
				fangxiang = "down"
			}

		}
		function createFood(){
			//先清除一下表格中所有的☆
			for(var i = 0; i < 20; i++){
				for(var j = 0 ;j < 20; j++){
					document.getElementsByTagName("tr")[i].getElementsByTagName("td")[j].innerHTML = ""
				}
			}
			do{
				//一把锁
				var lock = false;
				var randomRow = parseInt(Math.random() * 20);
				var randomCol = parseInt(Math.random() * 20);
				//判断，如果随机的row和col和蛇的蛇的身上某一块重合了，就把锁lock变为true，然后while会执行下一次循环，所以循环外面是得不到有重合的randomRow和randomCol的
				for(var i = 0; i < snakeArr.length; i++){
					if(randomRow == snakeArr[i].row && randomCol == snakeArr[i].col){
						lock = true;
					}
				}
				// 循环的判断条件，如果为false，就跳出循环，如果为true就执行下一次循环
			}while(lock)
	
			// 随机某一行某一列产生食物，也就是让innerHTML有文本
			// 这里的randomRow和randomCol是没有重合的随机row和col
			document.getElementsByTagName("tr")[randomRow].getElementsByTagName("td")[randomCol].innerHTML = "★"
		}
		createFood()
		function die(){
			alert("游戏结束！您的分数为"+score+"分")
			clearInterval(timer)
		}
		//开发游戏最早的机理：清屏-更新-渲染
		var timer = setInterval(function(){
			//清屏，每500毫秒清除画布上所有的颜色
			clear()
			// 更新-更新数据，也就是最新蛇的位置
			// 头部增加
			if(fangxiang == "right"){
				//判断向右运动的死亡范围,如果蛇的下一次运动大于19了，就判断是死亡了
				if(snakeArr[0].col+1 > 19){
					 die()
					return;
				}
				snakeArr.unshift({"row":snakeArr[0].row,"col":snakeArr[0].col+1});
			}else if(fangxiang == "down"){
				//判断向右运动的死亡范围,如果蛇的下一次运动大于19了，就判断是死亡了
				if(snakeArr[0].row+1 > 19){
					 die()
					return;
				}
				snakeArr.unshift({"row":snakeArr[0].row+1,"col":snakeArr[0].col});
			}else if(fangxiang == "up"){
				//判断向右运动的死亡范围,如果蛇的下一次运动大于19了，就判断是死亡了
				if(snakeArr[0].row-1 < 0){
					 die()
					return;
				}
				snakeArr.unshift({"row":snakeArr[0].row-1,"col":snakeArr[0].col});
			}else if(fangxiang == "left"){
				//判断向右运动的死亡范围,如果蛇的下一次运动大于19了，就判断是死亡了
				if(snakeArr[0].col-1 < 0){
					 die()
					return;
				}
				snakeArr.unshift({"row":snakeArr[0].row,"col":snakeArr[0].col-1});
			}
			// 判断蛇迟到食物,如果蛇的头部innerHTML不是☆的时候就是说明没有吃到食物，就pop()
			if(document.getElementsByTagName("tr")[snakeArr[0].row].getElementsByTagName("td")[snakeArr[0].col].innerHTML != "★"){
				// 尾删
				snakeArr.pop()
			}else{
				//创建新的食物
				createFood()
				// 吃到食物加分
				score ++;
				// 更改分数文本
				document.getElementsByTagName("h2")[0].innerHTML = "分数："+score
			}
			// 渲染-渲染更新数据之后的蛇
			renderSnake()
			
		},300)
	</script>
</body>
</html>